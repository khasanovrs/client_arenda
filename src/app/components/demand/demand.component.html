<div class="---page-clients">

  <div class="---tabs ---tabs--finance">
    <div class="---h-filters-wrapper ---d-flex ---justify-content-between ---align-items-start">
      <div class="---d-flex ---form ---align-items-start">
        <div class="---search ---field ---pos-rel">
          <input class="---input" placeholder="Поиск по складу" [(ngModel)]="filters.like"
                 (keyup)="getEquipments()">
          <div class="---field ---col-12 ---col-sm-6">
            <label>Склад</label>
            <div class="---select">
              <select [(ngModel)]="filters.stock" (change)="getEquipments()">
                <option *ngFor="let stock of stocks" [ngValue]="stock.val">
                  {{stock.name}}
                </option>
              </select>
            </div>

            <div (click)="changeType('hire')">Заявки</div>
            <div (click)="changeType('eq')">Оборудования</div>
          </div>
        </div>
      </div>

      <div (click)="addNewEquipments.show=true" class="---btn ---btn--fill-acent">
        Создать оборудование
      </div>
    </div>

    <div class="---t-wrapper">
      <table matSort (matSortChange)="sortData($event)">
        <tr>
          <ng-container *ngFor="let activeField of activeFields">
            <th *ngIf="activeField.flag===1" mat-sort-header="{{activeField.code}}">{{activeField.name}}</th>
          </ng-container>
        </tr>

        <tr *ngFor="let equipment of equipmentsList | paginate: { itemsPerPage: 50, currentPage: p }"
            class="cursor-pointer">
          <td *ngIf="activeFieldsTables['name']===1">{{equipment.name}}</td>
          <td *ngIf="activeFieldsTables['stock']===1">{{equipment.stock}}</td>
          <td *ngIf="activeFieldsTables['count_demand']===1">{{equipment.count_demand}}</td>
          <td *ngIf="activeFieldsTables['user']===1">{{equipment.user}}</td>
          <td *ngIf="activeFieldsTables['client']===1">{{equipment.client}}</td>
          <td *ngIf="activeFieldsTables['coment']===1">{{equipment.coment}}</td>
          <td *ngIf="activeFieldsTables['date_create']===1">{{equipment.date_create}}</td>
        </tr>
      </table>
    </div>

    <div
      class="---block--bg-white ---block-pagination ---d-flex ---align-items-center ---justify-content-between ---radius-5">
      <pagination-controls previousLabel='' nextLabel="" (pageChange)="p = $event"></pagination-controls>
      <div>Всего записей — <span class="---font-600">{{equipmentsList.length | digitsNumbers}}</span></div>
    </div>
  </div>
</div>

<div *ngIf="addNewEquipments.show"
     class="---d-flex ---modal --justify-content-center ---align-items-start ---justify-content-center">
  <div class="---wrapper">

    <div class="---js-close-modal ---js-close-modal-icon" (click)="addNewEquipments.show=false"></div>

    <app-equipment-create-mini [branch]="1"></app-equipment-create-mini>
  </div>
</div>
